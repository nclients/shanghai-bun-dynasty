---
import PrimaryButton from "./ui/PrimaryButton.astro";
import SecondaryButton from "./ui/SecondaryButton.astro";
import OrderOnlineBtn from "./ui/OrderOnlineBtn.astro";
import { cn } from "../utils/cn";

const { content, section } = Astro.props;
---

<section
  class={cn(section?.type !== "hero" ? "pt-16 sm:pt-48 md:pt-64" : "")}
  style={section?.type !== "hero"
    ? `background-color: ${section?.bgColor}; opacity: ${section?.bgOpacity}; scroll-margin-top: 150px;`
    : ""}
  id={`${section?.id || ""}`}
>
  <div
    class={cn(
      "relative lg:overflow-hidden",
      `${section?.sectionType !== "video" ? "py-8 lg:py-16" : ""} ${section?.bottomRounded ? `rounded-b-${section?.bottomRounded}` : ""}`
    )}
    style={`
      ${section?.sectionType === "imgBg" && section?.height ? `height: ${section?.height}vh;` : ""}
    `}
  >
    {
      section?.sectionType === "video" ? (
        <div
          class="hidden sm:block h-full overflow-hidden"
          style="padding:56.25% 0 0 0;position:relative;"
        >
          <iframe
            src={
              section?.bgVideoType === "vimeo"
                ? `https://player.vimeo.com/video/${section?.bgVideoId}?autoplay=1&loop=1&background=1`
                : section?.bgVideoType === "gjw"
                  ? `https://www.ganjingworld.com/zh-CN/embed/${section?.bgVideoId}?autoplay=1&loop=1&controls=0&mute=1`
                  : section?.bgVideoType === "youtube"
                    ? `https://www.youtube.com/embed/${section?.bgVideoId}?controls=0&autoplay=1&loop=1&mute=1`
                    : ""
            }
            class="absolute inset-0 -z-10 h-full w-full object-cover"
            allow="accelerometer; autoplay;"
            allowfullscreen
          />
          <div class="absolute inset-0 w-full h-full flex justify-center items-center">
            <div class="text-center">
              <h1
                class="text-3xl font-bold tracking-tight sm:text-6xl text-center"
                style={`color: ${section?.titleColor}`}
              >
                {section?.title.map((line: string, index: number) => (
                  <Fragment key={index}>
                    <span class="block mt-4">{line}</span>
                  </Fragment>
                ))}
              </h1>
              {section?.description.map((info: string, index: number) => (
                <Fragment key={index}>
                  <p
                    class="mt-6 text-lg leading-6 max-w-3xl text-center"
                    style={`color: ${section?.descriptionColor}`}
                  >
                    {info}
                  </p>
                </Fragment>
              ))}

              <div class="mt-10 flex items-center justify-center gap-x-6 text-center">
                {section?.addOrderOnlineBtn ? (
                  <OrderOnlineBtn
                    content={content}
                    text={section?.orderOnlineBtnInsteadText || "Order Online"}
                  />
                ) : (
                  ""
                )}
                {section?.addTableReservationBtn && (
                  <SecondaryButton
                    content={content}
                    text="Table Reservation"
                    href={`${content?.tableReservationLink}`}
                  />
                )}
                {section?.showOtherBtn && section?.btn1Text ? (
                  <PrimaryButton
                    content={content}
                    text={`${section?.btn1Text ? section?.btn1Text : "Order Online"}`}
                    href={
                      section.btn1Href
                        ? section.btn1Href
                        : content.orderOnlineLink
                    }
                  />
                ) : (
                  ""
                )}
                {section?.showOtherBtn && section?.btn2Text ? (
                  <SecondaryButton
                    content={content}
                    text={`${section?.btn2Text ? section?.btn2Text : "Table Reservation"}`}
                    href={
                      section?.btn2Href
                        ? section?.btn2Href
                        : content.tableReservationLink
                    }
                  />
                ) : (
                  ""
                )}
              </div>
            </div>
          </div>
          <script src="https://player.vimeo.com/api/player.js" />
        </div>
      ) : (
        ""
      )
    }
    {
      section?.bgImg ? (
        <img
          src={`/${section?.bgImg}`}
          alt={section?.bgImgAlt}
          class={cn(
            "absolute inset-0 -z-10 h-full w-full object-cover",
            `${section?.sectionType === "video" ? "sm:hidden" : ""}`
          )}
        />
      ) : (
        ""
      )
    }
    {
      section?.bgColor ? (
        <>
          <span
            class="absolute -z-10 w-full inset-0 top-0 left-0"
            style={`background-color:${section.bgColor}; opacity: ${section?.bgOpacity}`}
          />
        </>
      ) : (
        ""
      )
    }
    {
      section?.bottomInfo ? (
        <span>
          <span
            class="absolute -z-10 w-full h-16 inset-x-0 bottom-0 left-0 text-white font-semibold flex justify-center items-center"
            style="background-color:#000000; opacity: 0.95"
          >
            {section.bottomInfo}
          </span>
        </span>
      ) : (
        ""
      )
    }
    <div
      class={cn(
        "m-auto max-w-2xl md:max-w-7xl flex flex-col justify-center items-center",
        `${section?.sectionType === "video" ? "sm:hidden" : ""}`
      )}
    >
      {
        section.sectionType === "imgBg" ||
        (section.sectionType === "video" && !section?.imgPosition) ? (
          <div
            class={`absolute inset-0 w-full h-full flex justify-center items-center`}
          >
            <div class="text-center">
              <div>
                <h1
                  class="text-3xl font-bold tracking-tight sm:text-6xl leading-12 text-center"
                  style={`color: ${section.titleColor}`}
                >
                  {section?.title.map((line: string, index: number) => (
                    <Fragment key={index}>
                      <span class="block mt-4">{line}</span>
                    </Fragment>
                  ))}
                </h1>

                {section.description.map((info: string, index: number) => (
                  <Fragment key={index}>
                    <p
                      class="mt-8 text-base sm:text-3xl text-center"
                      style={`color: ${section.descriptionColor}`}
                    >
                      {info}
                    </p>
                  </Fragment>
                ))}
                <div class="mt-10 flex items-center justify-center gap-x-6">
                  {section?.addOrderOnlineBtn ? (
                    <OrderOnlineBtn
                      content={content}
                      text={
                        content?.header?.orderOnlineBtnInsteadText ||
                        "Order Online"
                      }
                    />
                  ) : (
                    ""
                  )}
                  {section?.addTableReservationBtn && (
                    <SecondaryButton
                      content={content}
                      text="Table Reservation"
                      href={`${content?.tableReservationLink}`}
                    />
                  )}
                  {section?.showOtherBtn && section?.btn1Text ? (
                    <PrimaryButton
                      content={content}
                      text={`${section?.btn1Text ? section?.btn1Text : "Order Online"}`}
                      href={
                        section.btn1Href
                          ? section.btn1Href
                          : content.orderOnlineLink
                      }
                    />
                  ) : (
                    ""
                  )}
                  {section?.showOtherBtn && section?.btn2Text ? (
                    <SecondaryButton
                      content={content}
                      text={`${section?.btn2Text ? section?.btn2Text : "Table Reservation"}`}
                      href={
                        section?.btn2Href
                          ? section?.btn2Href
                          : content.tableReservationLink
                      }
                    />
                  ) : (
                    ""
                  )}
                </div>
              </div>
            </div>
          </div>
        ) : (
          ""
        )
      }
      {
        section.sectionType === "imgWithText" ||
        (section.sectionType === "video" && section?.imgPosition) ? (
          <div
            class={`${section.sectionType === "video" ? "block sm:hidden" : ""} relative isolate mx-auto max-w-7xl px-6 py-8 sm:pt-0 lg:pt-20 lg:grid lg:grid-cols-2 lg:content-center lg:gap-x-10 lg:px-8`}
            style={`${section.type !== "hero" ? "" : "padding-top:56px"}`}
          >
            {section.bannerImg ? (
              <div class="lg:flex-grow ">
                <img
                  src={`/${section.bannerImg}`}
                  class={`object-cover ${section.imgRounded ? `rounded-${section.imgRounded}` : ""} max-w-full drop-shadow-xl`}
                  alt={section.imgAlt}
                />
              </div>
            ) : (
              ""
            )}

            <div
              class={cn(
                "lg:flex lg:flex-col justify-center items-center text-center",
                section?.imgPosition === "imgRight" ? "order-first" : ""
              )}
            >
              {section?.type === "hero" ? (
                <div>
                  <h1
                    class="mt-10 max-w-lg text-4xl font-bold sm:text-6xl text-center"
                    style={`color:${section?.titleColor};`}
                  >
                    {section?.title.map((line: string, index: number) => (
                      <Fragment key={index}>
                        <span class="block mt-4">{line}</span>
                      </Fragment>
                    ))}
                  </h1>

                  {section?.description.map((info: string, index: number) => (
                    <Fragment key={index}>
                      <p
                        class="mt-6 text-lg leading-8 text-center"
                        style={`color:${section?.descriptionColor};`}
                      >
                        {info}
                      </p>
                    </Fragment>
                  ))}
                </div>
              ) : (
                ""
              )}

              {section.type === "feature" ? (
                <div>
                  <h2
                    class="mt-10 lg:mt-0 max-w-lg text-3xl font-bold tracking-tight sm:text-4xl text-center"
                    style={`color:${section?.titleColor};`}
                  >
                    {section?.title.map((line: string, index: number) => (
                      <Fragment key={index}>
                        <span class="block mt-2">{line}</span>
                      </Fragment>
                    ))}
                  </h2>

                  {section?.description.map((info: string, index: number) => (
                    <Fragment key={index}>
                      <p
                        class="mt-6 text-lg leading-8 text-center"
                        style={`color:${section?.descriptionColor};`}
                      >
                        {info}
                      </p>
                    </Fragment>
                  ))}

                  {section?.title2 ? (
                    <h3
                      class="mt-10 max-w-lg text-xl font-bold tracking-tight sm:text-2xl"
                      style={`color:${section?.title2Color};`}
                    >
                      {section.title2.includes("<br/>")
                        ? section.title2
                            .split("<br/>")
                            .map((line: string, index: number) => (
                              <Fragment key={index}>
                                <span style={{ display: "block" }}>{line}</span>
                              </Fragment>
                            ))
                        : section.title2}
                    </h3>
                  ) : (
                    ""
                  )}
                  {section?.description2 ? (
                    <p
                      class="mt-6 text-lg "
                      style={`color:${section?.description2Color};`}
                    >
                      {section.description2.map(
                        (info: string, index: number) => (
                          <Fragment key={index}>
                            <p
                              class="mt-6 text-lg leading-8 text-center"
                              style={`color:${section.description2Color};`}
                            >
                              {info}
                            </p>
                          </Fragment>
                        )
                      )}
                    </p>
                  ) : (
                    ""
                  )}
                  {section?.addOrderOnlineBtn ? (
                    <OrderOnlineBtn
                      content={content}
                      text={
                        section?.orderOnlineBtnInsteadText || "Order Online"
                      }
                    />
                  ) : (
                    ""
                  )}
                  {section?.addTableReservationBtn && (
                    <SecondaryButton
                      content={content}
                      text="Table Reservation"
                      href={`${content?.tableReservationLink}`}
                    />
                  )}
                  {section?.showOtherBtn && section?.btn1Text ? (
                    <PrimaryButton
                      content={content}
                      text={`${section?.btn1Text ? section?.btn1Text : "Order Online"}`}
                      href={
                        section.btn1Href
                          ? section.btn1Href
                          : content.orderOnlineLink
                      }
                    />
                  ) : (
                    ""
                  )}
                  {section?.showOtherBtn && section?.btn2Text ? (
                    <SecondaryButton
                      content={content}
                      text={`${section?.btn2Text ? section?.btn2Text : "Table Reservation"}`}
                      href={
                        section?.btn2Href
                          ? section?.btn2Href
                          : content.tableReservationLink
                      }
                    />
                  ) : (
                    ""
                  )}
                </div>
              ) : (
                ""
              )}
            </div>
          </div>
        ) : (
          ""
        )
      }
    </div>
  </div>
</section>
